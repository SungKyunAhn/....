/** 
 * @(#)Class12.java       1.0 04/09/16 *
 * 
 * Billing Data Class (Previous Month)
 * Copyright (c) 2004-2005 NuriTelecom, Inc.
 * All rights reserved. * 
 * This software is the confidential and proprietary information of 
 * Nuritelcom, Inc. ("Confidential Information").  You shall not 
 * disclose such Confidential Information and shall use it only in 
 * accordance with the terms of the license agreement you entered into long longVal
 * with Nuritelecom. 
 */
 
package com.aimir.fep.meter.parser.a1rlTable;

import com.aimir.fep.util.DataFormat;
import com.aimir.util.DateTimeUtil;

/**
 * @author Park YeonKyoung yeonkyoung@hanmail.net
 *
 * To change the template for this generated type comment go to
 * Window&gt;Preferences&gt;Java&gt;Code Generation&gt;Code and Comments
 */
public class Class12 {
	
	/* -------- TOU block 1 --------*/ 
	public final int OFS_AKWH1   = 0;
	public final int OFS_AKW1    = 7;
	public final int OFS_ATD1    = 10;
	public final int OFS_AKWCUM1 = 15;
	public final int OFS_AKWC1   = 18;
	
	public final int OFS_BKWH1   = 21;
	public final int OFS_BKW1    = 28;
	public final int OFS_BTD1    = 31;
	public final int OFS_BKWCUM1 = 36;
	public final int OFS_BKWC1   = 39;
	
	public final int OFS_CKWH1   = 42;
	public final int OFS_CKW1    = 49;
	public final int OFS_CTD1    = 52;
	public final int OFS_CKWCUM1 = 57;
	public final int OFS_CKWC1   = 60;
	
	public final int OFS_DKWH1   = 63;
	public final int OFS_DKW1    = 70;
	public final int OFS_DTD1    = 73;
	public final int OFS_DKWCUM1 = 78;
	public final int OFS_DKWC1   = 81;
	/* -------- TOU block 1 --------*/ 
	
	/* -------- TOU block 2 --------*/ 
	public final int OFS_AKWH2   = 84;
	public final int OFS_AKW2    = 91;
	public final int OFS_ATD2    = 94;
	public final int OFS_AKWCUM2 = 99;
	public final int OFS_AKWC2   = 102;
	
	public final int OFS_BKWH2   = 105;
	public final int OFS_BKW2    = 112;
	public final int OFS_BTD2    = 115;
	public final int OFS_BKWCUM2 = 120;
	public final int OFS_BKWC2   = 123;
	
	public final int OFS_CKWH2   = 126;
	public final int OFS_CKW2    = 133;
	public final int OFS_CTD2    = 136;
	public final int OFS_CKWCUM2 = 141;
	public final int OFS_CKWC2   = 144;
	
	public final int OFS_DKWH2   = 147;
	public final int OFS_DKW2    = 154;
	public final int OFS_DTD2    = 157;
	public final int OFS_DKWCUM2 = 162;
	public final int OFS_DKWC2   = 165;
	/* -------- TOU block 2 --------*/ 
	
	/* ----------- Quadrant KVARh data ------------ */
	public final int OFS_EKVARH4 = 168;
	public final int OFS_EKVARH3 = 175;
	public final int OFS_EKVARH2 = 182;
	public final int OFS_EKVARH1 = 189;
	/* ----------- Quadrant KVARh data ------------ */
	
	public final int OFS_ETKWH1  = 196;
	public final int OFS_ETKWH2  = 203;
	public final int OFS_EAVGPF  = 210;
	
	/* -------- TOU block 1 --------*/ 
	public final int LEN_AKWH1   = 7;
	public final int LEN_AKW1    = 3;
	public final int LEN_ATD1    = 5;
	public final int LEN_AKWCUM1 = 3;
	public final int LEN_AKWC1   = 3;
	
	public final int LEN_BKWH1   = 7;
	public final int LEN_BKW1    = 3;
	public final int LEN_BTD1    = 5;
	public final int LEN_BKWCUM1 = 3;
	public final int LEN_BKWC1   = 3;
	
	public final int LEN_CKWH1   = 7;
	public final int LEN_CKW1    = 3;
	public final int LEN_CTD1    = 5;
	public final int LEN_CKWCUM1 = 3;
	public final int LEN_CKWC1   = 3;
	
	public final int LEN_DKWH1   = 7;
	public final int LEN_DKW1    = 3;
	public final int LEN_DTD1    = 5;
	public final int LEN_DKWCUM1 = 3;
	public final int LEN_DKWC1   = 3;
	/* -------- TOU block 1 --------*/ 
	
	/* -------- TOU block 2 --------*/ 
	public final int LEN_AKWH2   = 7;
	public final int LEN_AKW2    = 3;
	public final int LEN_ATD2    = 5;
	public final int LEN_AKWCUM2 = 3;
	public final int LEN_AKWC2   = 3;
	
	public final int LEN_BKWH2   = 7;
	public final int LEN_BKW2    = 3;
	public final int LEN_BTD2    = 5;
	public final int LEN_BKWCUM2 = 3;
	public final int LEN_BKWC2   = 3;
	
	public final int LEN_CKWH2   = 7;
	public final int LEN_CKW2    = 3;
	public final int LEN_CTD2    = 5;
	public final int LEN_CKWCUM2 = 3;
	public final int LEN_CKWC2   = 3;
	
	public final int LEN_DKWH2   = 7;
	public final int LEN_DKW2    = 3;
	public final int LEN_DTD2    = 5;
	public final int LEN_DKWCUM2 = 3;
	public final int LEN_DKWC2   = 3;
	/* -------- TOU block 2 --------*/ 
	
	/* ----------- Quadrant KVARh data ------------ */
	public final int LEN_EKVARH4 = 7;
	public final int LEN_EKVARH3 = 7;
	public final int LEN_EKVARH2 = 7;
	public final int LEN_EKVARH1 = 7;
	/* ----------- Quadrant KVARh data ------------ */
	
	public final int LEN_ETKWH1  = 7;
	public final int LEN_ETKWH2  = 7;
	public final int LEN_EAVGPF  = 2;
	
	private byte[] data;
	
	
	/**
	 * Constructor
	 * @param data - except read data header, crch, crcl
	 */
	public Class12(byte[] data){
		this.data = data;
	}

	
	/**
	 * 
	 * TOU block 1
	 * Rate A
	 * Active Energy. [kWh] (Energy Format)
	 * @return - 8 byte hex data.
	 */	
	public byte[] parseAKWH1() throws Exception {
		return DataFormat.dec2hex(DataFormat.bcd2long(data,OFS_AKWH1,LEN_AKWH1));
	}
	
	/**
	 * 
	 * TOU block 1
	 * Rate A
	 * Active Power Maximum Demand. (Demand Format)
	 * @return - 8 byte hex data.
	 */
	public byte[] parseAKW1() throws Exception {
		long longVal = DataFormat.bcd2dec(data,OFS_AKW1,LEN_AKW1);
		return DataFormat.dec2hex(longVal);
	}
	
	/**
	 * 
	 * TOU block 1
	 * Rate A
	 * Maximum Demand Date and Time.
	 * @return - 8 byte hex data.
	 */
	public byte[] parseATD1() throws Exception {
		
		byte[] date = new byte[6];
		String s = DataFormat.bcd2str(data,OFS_ATD1,LEN_ATD1);
		
		int curryy = (Integer.parseInt(DateTimeUtil
                .getCurrentDateTimeByFormat("yyyy"))/100)*100;
		int year   = Integer.parseInt(s.substring( 0,2));
		if(year != 0){
			year   = Integer.parseInt(s.substring( 0,2))+curryy;
		}
		int month  = Integer.parseInt(s.substring( 2,4));
		int day    = Integer.parseInt(s.substring( 4,6));
		int hh     = Integer.parseInt(s.substring( 6,8));
		int mm     = Integer.parseInt(s.substring( 8,10));
		
		date[0] = (byte) (year >> 8);
		date[1] = (byte) (0xff & year);
		date[2] = (byte) month;
		date[3] = (byte) day;
		date[4] = (byte) hh;
		date[5] = (byte) mm;
		
		return date;
		
	}
		
	/**
	 * 
	 * TOU block 1
	 * Rate A
	 * Active Power Cumulative Demand. (Demand Format)
	 * @return -  8 byte hex data
	 */
	public byte[] parseAKWCUM1() throws Exception {
		long longVal = DataFormat.bcd2long(data,OFS_AKWCUM1,LEN_AKWCUM1);
		return DataFormat.dec2hex(longVal);
	}

	/**
	 * 
	 * TOU block 1
	 * Rate B
	 * Active Energy. [kWh] (Energy Format)
	 * @return -  8 byte hex data
	 */
	public byte[] parseBKWH1() throws Exception {
		return DataFormat.dec2hex(DataFormat.bcd2long(data,OFS_BKWH1,LEN_BKWH1));
	}
	
	/**
	 * 
	 * TOU block 1
	 * Rate B
	 * Active Power Maximum Demand. (Demand Format)
	 * @return -  8 byte hex data.
	 */
	public byte[] parseBKW1() throws Exception {
		long longVal = DataFormat.bcd2dec(data,OFS_BKW1,LEN_BKW1);
		return DataFormat.dec2hex(longVal);
	}
	
	/**
	 * 
	 * TOU block 1
	 * Rate B 
	 * Maximum Demand Date and Time
	 * @return
	 */
	public byte[] parseBTD1() throws Exception {
		
		byte[] date = new byte[6];
		String s =  DataFormat.bcd2str(data,OFS_BTD1,LEN_BTD1);	
		
		int curryy = (Integer.parseInt(DateTimeUtil
                .getCurrentDateTimeByFormat("yyyy"))/100)*100;
		int year   = Integer.parseInt(s.substring( 0,2));
		if(year != 0){
			year   = Integer.parseInt(s.substring( 0,2))+curryy;
		}
		int month  = Integer.parseInt(s.substring( 2,4));
		int day    = Integer.parseInt(s.substring( 4,6));
		int hh     = Integer.parseInt(s.substring( 6,8));
		int mm     = Integer.parseInt(s.substring( 8,10));
		
		date[0] = (byte) (year >> 8);
		date[1] = (byte) (0xff & year);
		date[2] = (byte) month;
		date[3] = (byte) day;
		date[4] = (byte) hh;
		date[5] = (byte) mm;
		
		return date;		
	}
	
	/**
	 * 
	 * TOU block 1
	 * Rate B
	 * Active Power Cumulative Demand. (Demand Format)
	 * @return - 8 byte hex data.
	 */
	public byte[] parseBKWCUM1() throws Exception {
		long longVal = DataFormat.bcd2long(data,OFS_BKWCUM1,LEN_BKWCUM1);
		return DataFormat.dec2hex(longVal);
	}

	/**
	 * 
	 * TOU block 1
	 * Rate C
	 * Active Energy. [kWh] (Energy Format)
	 * @return - 8 byte hex data
	 */
	public byte[] parseCKWH1() throws Exception {
		long longVal = DataFormat.bcd2long(data,OFS_CKWH1,LEN_CKWH1);
		return DataFormat.dec2hex(longVal);	
	}
	
	/**
	 * 
	 * TOU block 1
	 * Rate C
	 * Active Power Maximum Demand. (Demand Format)
	 * @return -  8 byte hex data
	 */
	public byte[] parseCKW1() throws Exception {
		long longVal = DataFormat.bcd2dec(data,OFS_CKW1,LEN_CKW1);
		return DataFormat.dec2hex(longVal);
	}
	
	/**
	 * 
	 * TOU block 1
	 * Rate C
	 * Maximum Demand Date and Time.
	 * @return
	 */
	public byte[] parseCTD1() throws Exception {
		
		byte[] date = new byte[6];
		String s = DataFormat.bcd2str(data,OFS_CTD1,LEN_CTD1);	
		
		int curryy = (Integer.parseInt(DateTimeUtil
                .getCurrentDateTimeByFormat("yyyy"))/100)*100;
		int year   = Integer.parseInt(s.substring( 0,2));
		if(year != 0){
			year   = Integer.parseInt(s.substring( 0,2))+curryy;
		}
		int month  = Integer.parseInt(s.substring( 2,4));
		int day    = Integer.parseInt(s.substring( 4,6));
		int hh     = Integer.parseInt(s.substring( 6,8));
		int mm     = Integer.parseInt(s.substring( 8,10));
		
		date[0] = (byte) (year >> 8);
		date[1] = (byte) (0xff & year);
		date[2] = (byte) month;
		date[3] = (byte) day;
		date[4] = (byte) hh;
		date[5] = (byte) mm;
		
		return date;	
	}
	
	/**
	 * 
	 * TOU block 1
	 * Rate C
	 * Active Power Cumulative Demand. (Demand Format)
	 * @return -  8 byte hex data
	 */
	public byte[] parseCKWCUM1() throws Exception {
		long longVal = DataFormat.bcd2long(data,OFS_CKWCUM1,LEN_CKWCUM1);
		return DataFormat.dec2hex(longVal);
	}

	/**
	 * 
	 * TOU block 1
	 * Rate D
	 * Active Energy. [kWh] (Energy Format)
	 * 
	 * @return
	 */
	public double parseDKWH1() throws Exception {
		return DataFormat.bcd2dec(data,OFS_DKWH1,LEN_DKWH1)*Math.pow(-10,6);	
	}
	
	/**
	 * 
	 * TOU block 1
	 * Rate D
	 * Active Power Maximum Demand. (Demand Format)
	 * @return - 8 byte hex data.
	 */
	public byte[] parseDKW1() throws Exception {
		long longVal = DataFormat.bcd2dec(data,OFS_DKW1,LEN_DKW1);
		return DataFormat.dec2hex(longVal);
	}
	
	/**
	 * 
	 * TOU block 1
	 * Rate D
	 * Maximum Demand Date and Time.
	 * @return - 8 byte hex data
	 */
	public byte[] parseDTD1() throws Exception {
		
		byte[] date = new byte[6];
		String s =  DataFormat.bcd2str(data,OFS_DTD1,LEN_DTD1);
		
		int curryy = (Integer.parseInt(DateTimeUtil
                .getCurrentDateTimeByFormat("yyyy"))/100)*100;
		int year   = Integer.parseInt(s.substring( 0,2));
		if(year != 0){
			year   = Integer.parseInt(s.substring( 0,2))+curryy;
		}
		int month  = Integer.parseInt(s.substring( 2,4));
		int day    = Integer.parseInt(s.substring( 4,6));
		int hh     = Integer.parseInt(s.substring( 6,8));
		int mm     = Integer.parseInt(s.substring( 8,10));
		
		date[0] = (byte) (year >> 8);
		date[1] = (byte) (0xff & year);
		date[2] = (byte) month;
		date[3] = (byte) day;
		date[4] = (byte) hh;
		date[5] = (byte) mm;
		
		return date;		
	}
	
	/**
	 * 
	 * TOU block 1
	 * Rate D
	 * Active Power Cumulative Demand. (Demand Format)
	 * @return - 8 byte hex data
	 */
	public byte[] parseDKWCUM1() throws Exception {
		long longVal = DataFormat.bcd2long(data,OFS_DKWCUM1,LEN_DKWCUM1);
		return DataFormat.dec2hex(longVal);
	}

	/**
	 * 
	 * TOU block 1
	 * Rate D
	 * Active Power Coincident Demand. (Demand Format)
	 * @return
	 */
	public double parseDKWC1() throws Exception {
		return DataFormat.bcd2dec(data,OFS_DKWC1,LEN_DKWC1);			
	}

	/**
	 * 
	 * TOU block 2
	 * Rate A
	 * Reactive Energy. [kVARh] (Energy Format)
	 * @return -  8 byte hex data
	 */
	public byte[] parseAKWH2() throws Exception {
		long longVal = DataFormat.bcd2long(data,OFS_AKWH2,LEN_AKWH2);
		return DataFormat.dec2hex(longVal);
	}
	
	/**
	 * 
	 * TOU block 2
	 * Rate A
	 * Reactive Power Maximum Demand. (Demand Format)
	 * @return - 8 byte hex data
	 */
	public byte[] parseAKW2() throws Exception {
		long longVal = DataFormat.bcd2dec(data,OFS_AKW2,LEN_AKW2);
		return DataFormat.dec2hex(longVal);
	}
	
	/**
	 * 
	 * TOU block 2
	 * Rate A
	 * Maximum Demand Date and Time.
	 * @return -  8 byte hex data
	 */
	public byte[] parseATD2() throws Exception {
		
		byte[] date = new byte[6];
		String s =  DataFormat.bcd2str(data,OFS_ATD2,LEN_ATD2);
		
		int curryy = (Integer.parseInt(DateTimeUtil
                .getCurrentDateTimeByFormat("yyyy"))/100)*100;
		int year   = Integer.parseInt(s.substring( 0,2));
		if(year != 0){
			year   = Integer.parseInt(s.substring( 0,2))+curryy;
		}
		int month  = Integer.parseInt(s.substring( 2,4));
		int day    = Integer.parseInt(s.substring( 4,6));
		int hh     = Integer.parseInt(s.substring( 6,8));
		int mm     = Integer.parseInt(s.substring( 8,10));
		
		date[0] = (byte) (year >> 8);
		date[1] = (byte) (0xff & year);
		date[2] = (byte) month;
		date[3] = (byte) day;
		date[4] = (byte) hh;
		date[5] = (byte) mm;
		
		return date;
	}
	
	/**
	 * 
	 * TOU block 2
	 * Rate A
	 * Reactive Power Cumulative Demand. (Demand Format)
	 * @return - 8 byte hex data
	 */
	public byte[] parseAKWCUM2() throws Exception {
		long longVal = DataFormat.bcd2long(data,OFS_AKWCUM2,LEN_AKWCUM2);
		return DataFormat.dec2hex(longVal);
	}

	/**
	 * 
	 * TOU block 2
	 * Rate B
	 * Reactive Energy. [kVARh] (Energy Format)
	 * @return - 8 byte hex data
	 */
	public byte[] parseBKWH2() throws Exception {
		long longVal = DataFormat.bcd2long(data,OFS_BKWH2,LEN_BKWH2);
		return DataFormat.dec2hex(longVal);
	}
	
	/**
	 * 
	 * TOU block 2
	 * Rate B
	 * Reactive Power Maximum Demand. (Demand Format)
	 * @return - 8 byte hex data
	 */
	public byte[] parseBKW2() throws Exception {
		long longVal = DataFormat.bcd2dec(data,OFS_BKW2,LEN_BKW2);
		return DataFormat.dec2hex(longVal);
	}
	
	/**
	 * 
	 * TOU block 2
	 * Rate B
	 * Maximum Demand Date and Time
	 * @return
	 */
	public byte[] parseBTD2() throws Exception {
		
		byte[] date = new byte[6];
		String s =  DataFormat.bcd2str(data,OFS_BTD2,LEN_BTD2);
		
		int curryy = (Integer.parseInt(DateTimeUtil
                .getCurrentDateTimeByFormat("yyyy"))/100)*100;
		int year   = Integer.parseInt(s.substring( 0,2));
		if(year != 0){
			year   = Integer.parseInt(s.substring( 0,2))+curryy;
		}
		int month  = Integer.parseInt(s.substring( 2,4));
		int day    = Integer.parseInt(s.substring( 4,6));
		int hh     = Integer.parseInt(s.substring( 6,8));
		int mm     = Integer.parseInt(s.substring( 8,10));
		
		date[0] = (byte) (year >> 8);
		date[1] = (byte) (0xff & year);
		date[2] = (byte) month;
		date[3] = (byte) day;
		date[4] = (byte) hh;
		date[5] = (byte) mm;
		
		return date;
	}
	
	/**
	 * TOU block 2
	 * Rate B
	 * Reactive Power Cumulative Demand. (Demand Format)
	 * @return -  8 byte hex data.
	 */
	public byte[] parseBKWCUM2() throws Exception {
		long longVal = DataFormat.bcd2long(data,OFS_BKWCUM2,LEN_BKWCUM2);
		return DataFormat.dec2hex(longVal);
	}
	
	/**
	 * 
	 * TOU block 2
	 * Rate C
	 * Reactive Energy. [kVARh] (Energy Format)
	 * @return - 8 byte hex data
	 */
	public byte[] parseCKWH2() throws Exception {
		long longVal = DataFormat.bcd2long(data,OFS_CKWH2,LEN_CKWH2);
		return DataFormat.dec2hex(longVal);
	}
	
	/**
	 * 
	 * TOU block 2
	 * Rate C 
	 * Reactive Power Maximum Demand. (Demand Format)
	 * @return - 8 byte hex data
	 */
	public byte[] parseCKW2() throws Exception {
		long longVal = DataFormat.bcd2dec(data,OFS_CKW2,LEN_CKW2);
		return DataFormat.dec2hex(longVal);
	}
	
	/**
	 * 
	 * TOU block 2
	 * Rate C
	 * Maximum Demand Date and Time.
	 * @return - 8 byte hex data
	 */
	public byte[] parseCTD2() throws Exception {

		byte[] date = new byte[6];
		String s =  DataFormat.bcd2str(data,OFS_CTD2,LEN_CTD2);
		
		int curryy = (Integer.parseInt(DateTimeUtil
                .getCurrentDateTimeByFormat("yyyy"))/100)*100;
		int year   = Integer.parseInt(s.substring( 0,2));
		if(year != 0){
			year   = Integer.parseInt(s.substring( 0,2))+curryy;
		}
		int month  = Integer.parseInt(s.substring( 2,4));
		int day    = Integer.parseInt(s.substring( 4,6));
		int hh     = Integer.parseInt(s.substring( 6,8));
		int mm     = Integer.parseInt(s.substring( 8,10));
		
		date[0] = (byte) (year >> 8);
		date[1] = (byte) (0xff & year);
		date[2] = (byte) month;
		date[3] = (byte) day;
		date[4] = (byte) hh;
		date[5] = (byte) mm;
		
		return date;		
	}
	
	/**
	 * 
	 * TOU block 2
	 * Rate C
	 * Reactive Power Cumulative Demand. (Demand Format)
	 * @return - 8 byte hex data
	 */
	public byte[] parseCKWCUM2() throws Exception {
		long longVal = DataFormat.bcd2long(data,OFS_CKWCUM2,LEN_CKWCUM2);
		return DataFormat.dec2hex(longVal);
	}

	
	/**
	 * 
	 * TOU block 2
	 * Rate D
	 * Reactive Power Maximum Demand. (Demand Format)
	 * @return - 8 byte hex data.
	 */
	public byte[] parseDKW2() throws Exception {
		long longVal = DataFormat.bcd2dec(data,OFS_DKW2,LEN_DKW2);
		return DataFormat.dec2hex(longVal);
	}
	
	/**
	 * 
	 * TOU block 2
	 * Rate D
	 * Maximum Demand Date and Time
	 * @return - 8 byte hex data
	 */
	public byte[] parseDTD2() throws Exception {
		
		byte[] date = new byte[6];
		String s =  DataFormat.bcd2str(data,OFS_DTD2,LEN_DTD2);
		
		int curryy = (Integer.parseInt(DateTimeUtil
                .getCurrentDateTimeByFormat("yyyy"))/100)*100;
		int year   = Integer.parseInt(s.substring( 0,2));
		if(year != 0){
			year   = Integer.parseInt(s.substring( 0,2))+curryy;
		}
		int month  = Integer.parseInt(s.substring( 2,4));
		int day    = Integer.parseInt(s.substring( 4,6));
		int hh     = Integer.parseInt(s.substring( 6,8));
		int mm     = Integer.parseInt(s.substring( 8,10));
		
		date[0] = (byte) (year >> 8);
		date[1] = (byte) (0xff & year);
		date[2] = (byte) month;
		date[3] = (byte) day;
		date[4] = (byte) hh;
		date[5] = (byte) mm;
		
		return date;	
	}
	
	/**
	 * 
	 * TOU block 2
	 * Rate D
	 * Reactive Power Cumulative Demand. (Demand Format)
	 * @return  - 8 byte hex data
	 */
	public byte[] parseDKWCUM2() throws Exception {
		long longVal = DataFormat.bcd2long(data,OFS_DKWCUM2,LEN_DKWCUM2);
		return DataFormat.dec2hex(longVal);
	}

	/**
	 * 
	 * TOU block 1 total kWh.
	 * @return -  8 byte hex data
	 */
	public byte[] parseETKWH1() throws Exception {
		long longVal = DataFormat.bcd2long(data,OFS_ETKWH1,LEN_ETKWH1);
		return DataFormat.dec2hex(longVal);
	}

	/**
	 * 
	 * TOU block 1 total kVARh. 
	 * @return - 8 byte hex data
	 */
	public byte[] parseETKWH2() throws Exception {
		long longVal = DataFormat.bcd2long(data,OFS_ETKWH2,LEN_ETKWH2);
		return DataFormat.dec2hex(longVal);
	}

	/**
	 * 
	 * Average power factor.
	 * @return
	 */
	public float parseEAVGPF() throws Exception {
		return (float)(DataFormat.bcd2dec(data,OFS_EAVGPF,LEN_EAVGPF)*0.001);
	}


	/**
	 * 
	 * TOU block 1
	 * Rate C
	 * Active Power Coincident Demand. (Demand Format)
	 * @return
	 */
	public double parseCKWC1() throws Exception {
		return DataFormat.bcd2dec(data,OFS_CKWC1,LEN_CKWC1);			
	}

	/**
	 * 
	 * TOU block 1
	 * Rate B
	 * Active Power Coincident Demand. (Demand Format)
	 * @return
	 */
	public double parseBKWC1() throws Exception {
		return DataFormat.bcd2dec(data,OFS_BKWC1,LEN_BKWC1);		
	}
	
	/**
	 * 
	 * TOU block 1
	 * Rate A
	 * Active Power Coincident Demand. (Demand Format)
	 * @return 
	 */
	public double parseAKWC1() throws Exception {
		return DataFormat.bcd2dec(data,OFS_AKWC1,LEN_AKWC1);				
	}

	/**
	 * 
	 * TOU block 2
	 * Rate A
	 * Reactive Power Coincident Demand. (Demand Format)
	 * @return
	 */
	public double parseAKWC2() throws Exception {
		return DataFormat.bcd2dec(data,OFS_AKWC2,LEN_AKWC2);			
	}	

	/**
	 * 
	 * TOU block 2
	 * Rate C
	 * Reactive Power Coincident Demand. (Demand Format)
	 * @return
	 */
	public double parseCKWC2() throws Exception {
		return DataFormat.bcd2dec(data,OFS_CKWC2,LEN_CKWC2);			
	}

	/**
	 * 
	 * TOU block 2
	 * Rate D
	 * Reactive Energy . (Energy Format)
	 * @return
	 */
	public double parseDKWH2() throws Exception {
		return DataFormat.bcd2dec(data,OFS_DKWH2,LEN_DKWH2)*Math.pow(-10,6);
	}
	
	/**
	 * TOU block 2
	 * Rate B
	 * Reactive Power Coincident Demand. (Demand Format)
	 * @return
	 */
	public double parseBKWC2() throws Exception {
		return DataFormat.bcd2dec(data,OFS_BKWC2,LEN_BKWC2);		
	}

	/**
	 * 
	 * TOU block 2
	 * Rate D 
	 * Reactive Power Coincidet Demand. (Demand Format)
	 * @return
	 */
	public double parseDKWC2() throws Exception {
		return DataFormat.bcd2dec(data,OFS_DKWC2,LEN_DKWC2);		
	}

	/**
	 * 
	 * Quadrant kVARh data.
	 * Q4 - Total [kVARh]
	 * Exist only PowerPlus A1R Meter 
	 * @return
	 */
	public double parseEKVARH4() throws Exception {
		return DataFormat.bcd2dec(data,OFS_EKVARH4,LEN_EKVARH4)*Math.pow(-10,6);
	}

	/**
	 * 
	 * Quadrant kVARh data.
	 * Q3 - Total [kVARh]
	 * Exist only PowerPlus A1R Meter
	 * @return
	 */
	public double parseEKVARH3() throws Exception {
		return DataFormat.bcd2dec(data,OFS_EKVARH3,LEN_EKVARH3)*Math.pow(-10,6);
	}
	
	/**
	 * 
	 * Quadrant kVARh data.
	 * Q2 - Total [kVARh]
	 * Exist only PowerPlus A1R Meter
	 * @return
	 */
	public double parseEKVARH2() throws Exception {
		return DataFormat.bcd2dec(data,OFS_EKVARH2,LEN_EKVARH2)*Math.pow(-10,6);
	}

	/**
	 * 
	 * Quadrant kVARh data.
	 * Q1 - Total [kVARh]
	 * Exist only PowerPlus A1R Meter
	 * @return
	 */
	public double parseEKVARH1() throws Exception {
		return DataFormat.bcd2dec(data,OFS_EKVARH1,LEN_EKVARH1)*Math.pow(-10,6);
	}

}
